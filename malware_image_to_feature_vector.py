
# coding: utf-8

# In[ ]:

import numpy as np
import os
import cv2
import pandas as pd


# In[ ]:

# Reshape the size of the malware images uniformly
size      = 32 
# name of the folder containing the malware images
directory = 'data'


# In[ ]:

data_dir = os.listdir(directory)
for i in data_dir:
    print i


# In[ ]:

features = []
labels   = []
category = []

for (index,directory) in zip(range(len(data_dir)), data_dir):
    for filename in os.listdir('data/' + directory):
        img        = cv2.imread('data/'+ directory + '/' + filename,0)
        compressed = cv2.resize(img,(size,size))
        flattened  = compressed.flatten()
        features.append(flattened)
        labels.append(index)

for numbers in labels:
    category.append(data_dir[numbers])


# In[ ]:

zip(features,labels,category)


# In[ ]:

data = pd.DataFrame(features)


# In[ ]:

data['category'] = category


# In[ ]:

data['labels']   = labels


# In[ ]:

data.to_csv('malware_data_32.csv',sep=',')


# In[ ]:

print 'done'


# In[ ]:



